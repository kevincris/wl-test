{"version":3,"sources":["./src/app/common/allocations/allocations.component.ts","./src/app/common/allocations/allocations.component.html"],"names":[],"mappings":"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","file":"default~admin-admin-module~discover-discover-module.js","sourcesContent":["import { HttpClient, HttpHeaders } from '@angular/common/http'\nimport { ChangeDetectorRef, Component } from '@angular/core'\nimport { ActivatedRoute, Router } from '@angular/router'\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap'\nimport { TranslateService } from '@ngx-translate/core'\nimport { Allocation, RPCResult } from '../api-interfaces'\nimport { ListComponent } from '../list.component'\nimport { ConfirmationService } from '../services/confirmation.service'\nimport { SessionService } from '../services/session.service'\nimport { ToastrService } from '../services/toastr.service'\n\n@Component({\n    selector: 'allocations',\n    templateUrl: 'allocations.component.html',\n})\nexport class AllocationsComponent extends ListComponent<Allocation> {\n    protected apiUrl = '/allocations'\n\n    constructor(\n        http: HttpClient,\n        ngbModal: NgbModal,\n        changeDetector: ChangeDetectorRef,\n        route: ActivatedRoute,\n        router: Router,\n        session: SessionService,\n        confirmation: ConfirmationService,\n        private toastr: ToastrService,\n        public translate: TranslateService\n    ) {\n        super(http, ngbModal, changeDetector, route, router, session, confirmation)\n    }\n\n    public approve(allocation: Allocation): void {\n        this.http\n            .post<RPCResult<Allocation>>(\n                `/allocations/${allocation.id}`,\n                {\n                    id: Math.floor(Math.random() * 10000),\n                    jsonrpc: '2.0',\n                    method: 'approve',\n                },\n                {\n                    headers: new HttpHeaders({ 'Content-Type': 'application/json-rpc' }),\n                }\n            )\n            .subscribe(response => {\n                Object.assign(allocation, response.result)\n                this.toastr.success(this.translate.instant('allocations.allocation-approved'))\n                this.updateEvent.next()\n            })\n    }\n\n    public cancel(allocation: Allocation): void {\n        this.http\n            .patch<Allocation>(\n                `/allocations/${allocation.id}`,\n                [\n                    {\n                        op: 'replace',\n                        path: '/status',\n                        value: 'cancelled',\n                    },\n                ],\n                {\n                    headers: new HttpHeaders({ 'Content-Type': 'application/json-patch+json' }),\n                }\n            )\n            .subscribe(response => {\n                Object.assign(allocation, response)\n                this.toastr.success(this.translate.instant('allocations.allocation-canceled'))\n                this.updateEvent.next()\n            })\n    }\n}\n","export default \"<section class=\\\"container-fluid\\\">\\n    <div class=\\\"card\\\">\\n        <div class=\\\"card-header d-flex justify-content-between align-items-center\\\">\\n            <span>{{ 'common.allocations' | translate }}</span>\\n            <div>\\n                <button type=\\\"button\\\" class=\\\"btn btn-primary btn-sm\\\" (click)=\\\"requestExport()\\\">\\n                    <fa-icon [icon]=\\\"faDownload\\\" class=\\\"mr-1\\\"></fa-icon> {{ 'common.export' | translate }}\\n                </button>\\n            </div>\\n        </div>\\n        <div class=\\\"card-body\\\">\\n            <div class=\\\"row no-gutters align-items-center mb-3\\\">\\n                <div class=\\\"col-lg-7 mb-2 mb-lg-0\\\">\\n                    <div class=\\\"input-group\\\">\\n                        <span class=\\\"input-group-prepend\\\">\\n                            <span class=\\\"input-group-text\\\"><fa-icon [icon]=\\\"faSearch\\\"></fa-icon></span>\\n                        </span>\\n                        <input\\n                            type=\\\"text\\\"\\n                            name=\\\"searchText\\\"\\n                            (ngModelChange)=\\\"searchEvent.next()\\\"\\n                            [placeholder]=\\\"'common.search' | translate\\\"\\n                            class=\\\"form-control\\\"\\n                            [(ngModel)]=\\\"search\\\"\\n                        />\\n                    </div>\\n                </div>\\n                <div class=\\\"col-lg-17 d-flex justify-content-between align-items-center\\\">\\n                    <span class=\\\"ml-lg-3\\\"\\n                        >{{ count | number }} {{ (count === 1 ? 'common.entry-found' : 'common.entries-found') | translate | lowercase }}</span\\n                    >\\n                    <div class=\\\"d-flex align-items-center\\\">\\n                        <ng-select\\n                            class=\\\"mr-2\\\"\\n                            [(ngModel)]=\\\"limit\\\"\\n                            dropdownPosition=\\\"auto\\\"\\n                            (change)=\\\"select(1)\\\"\\n                            [items]=\\\"limitOpts\\\"\\n                            [placeholder]=\\\"'common.show-entries-per-page' | translate\\\"\\n                            [clearable]=\\\"false\\\"\\n                            [searchable]=\\\"false\\\"\\n                            required\\n                        >\\n                            <ng-template ng-label-tmp let-item=\\\"item\\\">{{ 'common.show-entries' | translate: { value: item } }}</ng-template>\\n                            <ng-template ng-option-tmp let-item=\\\"item\\\">{{ item }} {{ 'common.entries' | translate }}</ng-template>\\n                        </ng-select>\\n                        <ngb-pagination\\n                            [(page)]=\\\"page\\\"\\n                            [collectionSize]=\\\"count\\\"\\n                            (pageChange)=\\\"select()\\\"\\n                            [pageSize]=\\\"limit\\\"\\n                            [maxSize]=\\\"5\\\"\\n                            [ellipses]=\\\"false\\\"\\n                            [rotate]=\\\"true\\\"\\n                            [boundaryLinks]=\\\"true\\\"\\n                        >\\n                        </ngb-pagination>\\n                    </div>\\n                </div>\\n            </div>\\n            <div class=\\\"table-responsive position-relative\\\">\\n                <table class=\\\"table table-hover table-bordered table-data\\\">\\n                    <thead class=\\\"thead-light\\\">\\n                        <tr>\\n                            <th scope=\\\"col\\\">#</th>\\n                            <th scope=\\\"col\\\">\\n                                Product\\n                                <fa-icon\\n                                    class=\\\"sort-toggle\\\"\\n                                    [icon]=\\\"getSortingDirection(['productId']) === 'DESC' ? faChevronUp : faChevronDown\\\"\\n                                    (click)=\\\"sort(['productId'], $event.ctrlKey || $event.metaKey)\\\"\\n                                    [ngClass]=\\\"{ active: isActiveSorting(['productId']) }\\\"\\n                                ></fa-icon>\\n                            </th>\\n                            <th scope=\\\"col\\\">\\n                                {{ 'allocations.investor' | translate }}\\n                                <fa-icon\\n                                    class=\\\"sort-toggle\\\"\\n                                    [icon]=\\\"getSortingDirection(['user', 'id']) === 'DESC' ? faChevronUp : faChevronDown\\\"\\n                                    (click)=\\\"sort(['user', 'id'], $event.ctrlKey || $event.metaKey)\\\"\\n                                    [ngClass]=\\\"{ active: isActiveSorting(['user', 'id']) }\\\"\\n                                ></fa-icon>\\n                            </th>\\n                            <th scope=\\\"col\\\" class=\\\"text-right\\\">\\n                                {{ 'common.amount' | translate }}\\n                                <fa-icon\\n                                    class=\\\"sort-toggle\\\"\\n                                    [icon]=\\\"getSortingDirection(['baseTransaction', 'amount']) === 'DESC' ? faChevronUp : faChevronDown\\\"\\n                                    (click)=\\\"sort(['baseTransaction', 'amount'], $event.ctrlKey || $event.metaKey)\\\"\\n                                    [ngClass]=\\\"{ active: isActiveSorting(['baseTransaction', 'amount']) }\\\"\\n                                ></fa-icon>\\n                            </th>\\n                            <th scope=\\\"col\\\" class=\\\"text-right\\\">\\n                                {{ 'common.units' | translate }}\\n                                <fa-icon\\n                                    class=\\\"sort-toggle\\\"\\n                                    [icon]=\\\"getSortingDirection(['counterTransaction', 'amount']) === 'DESC' ? faChevronUp : faChevronDown\\\"\\n                                    (click)=\\\"sort(['counterTransaction', 'amount'], $event.ctrlKey || $event.metaKey)\\\"\\n                                    [ngClass]=\\\"{ active: isActiveSorting(['counterTransaction', 'amount']) }\\\"\\n                                ></fa-icon>\\n                            </th>\\n                            <th scope=\\\"col\\\">\\n                                {{ 'common.status' | translate }}\\n                                <fa-icon\\n                                    class=\\\"sort-toggle\\\"\\n                                    [icon]=\\\"getSortingDirection(['status']) === 'DESC' ? faChevronUp : faChevronDown\\\"\\n                                    (click)=\\\"sort(['status'], $event.ctrlKey || $event.metaKey)\\\"\\n                                    [ngClass]=\\\"{ active: isActiveSorting(['status']) }\\\"\\n                                ></fa-icon>\\n                            </th>\\n                            <th scope=\\\"col\\\">\\n                                {{ 'common.created-at' | translate | titlecase }}\\n                                <fa-icon\\n                                    class=\\\"sort-toggle\\\"\\n                                    [icon]=\\\"getSortingDirection(['createdAt']) === 'DESC' ? faChevronUp : faChevronDown\\\"\\n                                    (click)=\\\"sort(['createdAt'], $event.ctrlKey || $event.metaKey)\\\"\\n                                    [ngClass]=\\\"{ active: isActiveSorting(['createdAt']) }\\\"\\n                                ></fa-icon>\\n                            </th>\\n                            <th scope=\\\"col\\\" *ngIf=\\\"['admin'].includes(session.user?.role)\\\">{{ 'common.actions' | translate }}</th>\\n                        </tr>\\n                    </thead>\\n                    <tbody>\\n                        <ng-container *ngIf=\\\"itemsStream | async; let items\\\">\\n                            <tr *ngFor=\\\"let allocation of items\\\">\\n                                <th scope=\\\"row\\\" [width]=\\\"'1%'\\\">\\n                                    <uuid [value]=\\\"allocation.id\\\"></uuid>\\n                                </th>\\n                                <td>{{ allocation.product?.currency?.code }}</td>\\n                                <td>\\n                                    <user-display [user]=\\\"allocation.user\\\"> </user-display>\\n                                </td>\\n                                <td class=\\\"text-right\\\" [ngClass]=\\\"allocation.status === 'cancelled' ? 'text-muted' : 'text-primary'\\\">\\n                                    {{ allocation.baseTransaction?.amount | amount: allocation.baseTransaction?.currency?.decimalPlaces }}\\n                                    {{ allocation.baseTransaction?.currency?.code }}\\n                                </td>\\n                                <td class=\\\"text-right\\\" [ngClass]=\\\"allocation.status === 'completed' ? 'text-green' : 'text-muted'\\\">\\n                                    {{ allocation.counterTransaction?.amount | amount: allocation.counterTransaction?.currency?.decimalPlaces }}\\n                                    {{ allocation.counterTransaction?.currency?.code }}\\n                                </td>\\n                                <td>\\n                                    <span\\n                                        class=\\\"text-capitalize badge badge-lg\\\"\\n                                        [ngClass]=\\\"{\\n                                            'badge-success': allocation.status === 'completed',\\n                                            'badge-info': allocation.status === 'pending',\\n                                            'badge-danger': allocation.status === 'cancelled'\\n                                        }\\\"\\n                                        >{{ allocation.status }}</span\\n                                    >\\n                                </td>\\n                                <td>{{ allocation.createdAt | date: 'medium' }}</td>\\n                                <td class=\\\"action\\\" *ngIf=\\\"['admin'].includes(session.user?.role)\\\">\\n                                    <div class=\\\"btn-group w-100\\\">\\n                                        <button\\n                                            type=\\\"button\\\"\\n                                            class=\\\"btn btn-primary-air btn-sm btn-block px-2\\\"\\n                                            (click)=\\\"$event.preventDefault()\\\"\\n                                            *ngIf=\\\"allocation.status !== 'pending'\\\"\\n                                            disabled\\n                                        >\\n                                            {{ 'common.view' | translate }}\\n                                        </button>\\n                                        <button\\n                                            type=\\\"button\\\"\\n                                            class=\\\"btn btn-success btn-sm btn-block px-2\\\"\\n                                            (click)=\\\"approve(allocation)\\\"\\n                                            *ngIf=\\\"allocation.status === 'pending'\\\"\\n                                        >\\n                                            Approve\\n                                        </button>\\n                                        <div\\n                                            class=\\\"btn-group\\\"\\n                                            ngbDropdown\\n                                            container=\\\"body\\\"\\n                                            placement=\\\"bottom-right\\\"\\n                                            *ngIf=\\\"allocation.status === 'pending'\\\"\\n                                        >\\n                                            <button\\n                                                class=\\\"btn btn-sm dropdown-toggle-split\\\"\\n                                                [ngClass]=\\\"allocation.status === 'pending' ? 'btn-success' : 'btn-primary-air'\\\"\\n                                                ngbDropdownToggle\\n                                            >\\n                                                <fa-icon [icon]=\\\"faCaretDown\\\"></fa-icon>\\n                                            </button>\\n                                            <div class=\\\"dropdown-menu dropdown-menu-sm\\\" ngbDropdownMenu>\\n                                                <a href ngbDropdownItem (click)=\\\"cancel(allocation); $event.preventDefault()\\\">{{\\n                                                    'common.cancel' | translate\\n                                                }}</a>\\n                                            </div>\\n                                        </div>\\n                                    </div>\\n                                </td>\\n                            </tr>\\n                            <tr *ngIf=\\\"items.length === 0\\\">\\n                                <td colspan=\\\"8\\\" class=\\\"text-center\\\">{{ 'common.no-entries-found' | translate }}</td>\\n                            </tr>\\n                        </ng-container>\\n                    </tbody>\\n                </table>\\n                <ng-container *ngIf=\\\"isFetching | async\\\">\\n                    <circle-spinner></circle-spinner>\\n                </ng-container>\\n            </div>\\n        </div>\\n    </div>\\n</section>\\n\";"],"sourceRoot":"webpack:///"}